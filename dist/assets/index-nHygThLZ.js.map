{"version":3,"file":"index-nHygThLZ.js","sources":["../../src/js/constants.js","../../src/js/api.js","../../src/js/models/story-model.js","../../src/js/map.js","../../src/js/presenters/home-presenter.js","../../src/js/utils/dom.js","../../src/js/db.js","../../src/js/views/home.js","../../src/js/utils/auth.js","../../src/js/views/landing.js","../../src/js/views/stories.js","../../src/js/notification.js","../../src/js/presenters/add-story-presenter.js","../../src/js/camera.js","../../src/js/views/add-story.js","../../src/js/presenters/detail-presenter.js","../../src/js/views/detail.js","../../src/js/presenters/login-presenter.js","../../src/js/views/login.js","../../src/js/presenters/register-presenter.js","../../src/js/views/register.js","../../src/js/views/subscribe.js","../../src/js/views/favorites.js","../../src/js/views/about.js","../../src/js/views/not-found.js","../../src/js/utils/transition.js","../../src/js/router.js","../../src/js/main.js"],"sourcesContent":["// src/js/constants.js\nexport const BASE_URL = \"https://story-api.dicoding.dev/v1\";\nexport const VAPID_PUBLIC_KEY =\n  \"BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk\";\n","// src/js/api.js - Enhanced API with Push Notification endpoints\nimport { BASE_URL } from \"./constants.js\";\n\nasync function handleResponse(response) {\n  const data = await response.json();\n  if (!response.ok) {\n    const errorMessage = data.message || `Server error: ${response.status}`;\n    throw new Error(errorMessage);\n  }\n  return data;\n}\n\nexport async function register({ name, email, password }) {\n  try {\n    if (!name || typeof name !== \"string\" || name.trim().length === 0) {\n      throw new Error(\"Nama tidak boleh kosong\");\n    }\n    if (!email || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)) {\n      throw new Error(\"Email tidak valid\");\n    }\n    if (!password || password.length < 8) {\n      throw new Error(\"Password harus minimal 8 karakter\");\n    }\n\n    console.log(\"Mengirim data registrasi:\", { name, email, password });\n\n    const response = await fetch(`${BASE_URL}/register`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ name, email, password }),\n    });\n\n    const data = await handleResponse(response);\n    console.log(\"Respons dari server (register):\", data);\n    return data;\n  } catch (error) {\n    console.error(\"Error registering:\", error.message);\n    throw new Error(error.message);\n  }\n}\n\nexport async function login({ email, password }) {\n  try {\n    if (!email || !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)) {\n      throw new Error(\"Email tidak valid\");\n    }\n    if (!password || password.length < 8) {\n      throw new Error(\"Password harus minimal 8 karakter\");\n    }\n\n    console.log(\"Mengirim data login:\", { email, password });\n\n    const response = await fetch(`${BASE_URL}/login`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ email, password }),\n    });\n\n    const data = await handleResponse(response);\n    console.log(\"Respons dari server (login):\", data);\n    return data;\n  } catch (error) {\n    console.error(\"Error logging in:\", error.message);\n    throw new Error(error.message);\n  }\n}\n\nexport async function addStory({ description, photo, lat, lon, token }) {\n  try {\n    if (!description || description.trim().length === 0) {\n      throw new Error(\"Deskripsi tidak boleh kosong\");\n    }\n    if (!photo) {\n      throw new Error(\"Foto wajib diunggah\");\n    }\n    if (!token) {\n      throw new Error(\"Token tidak ditemukan, silakan login terlebih dahulu\");\n    }\n\n    const formData = new FormData();\n    formData.append(\"description\", description);\n    formData.append(\"photo\", photo);\n    if (lat && lon) {\n      formData.append(\"lat\", lat);\n      formData.append(\"lon\", lon);\n    }\n\n    console.log(\"Mengirim data cerita:\", { description, lat, lon, token });\n\n    const response = await fetch(`${BASE_URL}/stories`, {\n      method: \"POST\",\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n      body: formData,\n    });\n\n    const data = await handleResponse(response);\n    console.log(\"Respons dari server (addStory):\", data);\n    return data;\n  } catch (error) {\n    console.error(\"Error adding story:\", error.message);\n    throw new Error(error.message);\n  }\n}\n\nexport async function addGuestStory({ description, photo, lat, lon }) {\n  try {\n    if (!description || description.trim().length === 0) {\n      throw new Error(\"Deskripsi tidak boleh kosong\");\n    }\n    if (!photo) {\n      throw new Error(\"Foto wajib diunggah\");\n    }\n\n    const formData = new FormData();\n    formData.append(\"description\", description);\n    formData.append(\"photo\", photo);\n    if (lat && lon) {\n      formData.append(\"lat\", lat);\n      formData.append(\"lon\", lon);\n    }\n\n    console.log(\"Mengirim data cerita guest:\", { description, lat, lon });\n\n    const response = await fetch(`${BASE_URL}/stories/guest`, {\n      method: \"POST\",\n      body: formData,\n    });\n\n    const data = await handleResponse(response);\n    console.log(\"Respons dari server (addGuestStory):\", data);\n    return data;\n  } catch (error) {\n    console.error(\"Error adding guest story:\", error.message);\n    throw new Error(error.message);\n  }\n}\n\nexport async function getStories({ token, page = 1, size = 10, location = 0 }) {\n  try {\n    if (!token) {\n      throw new Error(\"Token tidak ditemukan, silakan login terlebih dahulu\");\n    }\n\n    const params = new URLSearchParams({ page, size, location });\n    console.log(\"Mengambil daftar cerita dengan params:\", params.toString());\n\n    const response = await fetch(`${BASE_URL}/stories?${params}`, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    const data = await handleResponse(response);\n    console.log(\"Respons dari server (getStories):\", data);\n    return data;\n  } catch (error) {\n    console.error(\"Error getting stories:\", error.message);\n    throw new Error(error.message);\n  }\n}\n\nexport async function getStoryDetail(id, token) {\n  try {\n    if (!id) {\n      throw new Error(\"ID cerita tidak boleh kosong\");\n    }\n    if (!token) {\n      throw new Error(\"Token tidak ditemukan, silakan login terlebih dahulu\");\n    }\n\n    console.log(\"Mengambil detail cerita dengan ID:\", id);\n\n    const response = await fetch(`${BASE_URL}/stories/${id}`, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    const data = await handleResponse(response);\n    console.log(\"Respons dari server (getStoryDetail):\", data);\n    return data;\n  } catch (error) {\n    console.error(\"Error getting story detail:\", error.message);\n    throw new Error(error.message);\n  }\n}\n\n// Enhanced Push Notification API functions\nexport async function subscribeNotifications(subscription, token) {\n  try {\n    if (!subscription) {\n      throw new Error(\"Data subscription tidak boleh kosong\");\n    }\n    if (!token) {\n      throw new Error(\"Token tidak ditemukan, silakan login terlebih dahulu\");\n    }\n\n    // Clean subscription object - remove expirationTime and other browser-specific fields\n    const cleanSubscription = {\n      endpoint: subscription.endpoint,\n      keys: {\n        p256dh: subscription.keys.p256dh,\n        auth: subscription.keys.auth,\n      },\n    };\n\n    console.log(\"Mengirim data subscription ke server:\", cleanSubscription);\n\n    const response = await fetch(`${BASE_URL}/notifications/subscribe`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify(cleanSubscription),\n    });\n\n    const data = await handleResponse(response);\n    console.log(\"Respons dari server (subscribeNotifications):\", data);\n    return data;\n  } catch (error) {\n    console.error(\"Error subscribing to notifications:\", error.message);\n    throw new Error(error.message);\n  }\n}\n\nexport async function unsubscribeFromNotifications(endpoint, token) {\n  try {\n    if (!endpoint) {\n      throw new Error(\"Endpoint tidak boleh kosong\");\n    }\n    if (!token) {\n      throw new Error(\"Token tidak ditemukan, silakan login terlebih dahulu\");\n    }\n\n    console.log(\"Menghapus subscription dengan endpoint:\", endpoint);\n\n    const response = await fetch(`${BASE_URL}/notifications/subscribe`, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify({ endpoint }),\n    });\n\n    const data = await handleResponse(response);\n    console.log(\"Respons dari server (unsubscribeFromNotifications):\", data);\n    return data;\n  } catch (error) {\n    console.error(\"Error unsubscribing from notifications:\", error.message);\n    throw new Error(error.message);\n  }\n}\n\n// Trigger notification for new story (example implementation)\nexport async function triggerStoryNotification(storyData, token) {\n  try {\n    if (!token) {\n      throw new Error(\"Token tidak ditemukan, silakan login terlebih dahulu\");\n    }\n\n    const notificationPayload = {\n      title: \"New Story Added!\",\n      body: `${storyData.name} just shared a new story: ${storyData.description.substring(0, 50)}...`,\n      data: {\n        storyId: storyData.id,\n        url: `/#/detail/${storyData.id}`\n      }\n    };\n\n    console.log(\"Triggering story notification:\", notificationPayload);\n\n    const response = await fetch(`${BASE_URL}/notifications/trigger`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify(notificationPayload),\n    });\n\n    // Note: This endpoint might not exist in the actual API\n    // This is an example of how you would trigger notifications\n    if (response.ok) {\n      const data = await response.json();\n      console.log(\"Notification triggered successfully:\", data);\n      return data;\n    } else {\n      console.warn(\"Notification trigger endpoint not available\");\n      return null;\n    }\n  } catch (error) {\n    console.error(\"Error triggering story notification:\", error.message);\n    // Don't throw error here as this is not critical functionality\n    return null;\n  }\n}","// src/js/models/story-model.js\nimport { getStories, getStoryDetail, addStory, addGuestStory } from \"../api.js\"; // dari src/js/models/ ke src/js/api.js\n\nexport default class StoryModel {\n  async getStories({ token, page = 1, size = 10, location = 1 }) {\n    const response = await getStories({ token, page, size, location });\n    if (response.error) throw new Error(response.message);\n    return response.listStory;\n  }\n\n  async getStoryDetail(id, token) {\n    const response = await getStoryDetail(id, token);\n    if (response.error) throw new Error(response.message);\n    return response.story;\n  }\n\n  async addStory({ description, photo, lat, lon, token }) {\n    const response = await addStory({ description, photo, lat, lon, token });\n    if (response.error) throw new Error(response.message);\n    return response;\n  }\n\n  async addGuestStory({ description, photo, lat, lon }) {\n    const response = await addGuestStory({ description, photo, lat, lon });\n    if (response.error) throw new Error(response.message);\n    return response;\n  }\n}\n","// src/js/map.js\nimport L from \"leaflet\";\n\nexport function initMap(containerId, lat = -6.2, lon = 106.8, zoom = 13) {\n  const map = L.map(containerId).setView([lat, lon], zoom);\n  L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\n    attribution:\n      '© <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\n  }).addTo(map);\n  return map;\n}\n\nexport function addMarker(map, lat, lon, popupText) {\n  const marker = L.marker([lat, lon]).addTo(map);\n  if (popupText) {\n    marker.bindPopup(popupText).openPopup();\n  }\n  return marker;\n}\n\nexport function onMapClick(map, callback) {\n  map.on(\"click\", (e) => {\n    const { lat, lng } = e.latlng;\n    callback(lat, lng);\n  });\n}","// src/js/presenters/home-presenter.js\nimport StoryModel from \"../models/story-model.js\"; // dari src/js/presenters/ ke src/js/models/story-model.js\nimport { initMap, addMarker } from \"../map.js\"; // dari src/js/presenters/ ke src/js/map.js\n\nexport default class HomePresenter {\n  constructor(view) {\n    this.view = view;\n    this.model = new StoryModel();\n  }\n\n  async loadStories() {\n    try {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        this.view.showMessage(\"Silakan login terlebih dahulu!\", () => {\n          window.location.hash = \"#/login\";\n        });\n        return;\n      }\n\n      const response = await this.getStories(token);\n      if (response.error) {\n        throw new Error(response.message);\n      }\n\n      this.view.displayStories(response);\n    } catch (error) {\n      this.view.showMessage(`Gagal memuat cerita: ${error.message}`, () => {\n        this.loadStories();\n      });\n    }\n  }\n\n  async getStories(token) {\n    return await this.model.getStories({\n      token,\n      page: 1,\n      size: 10,\n      location: 1,\n    });\n  }\n\n  initMap(containerId, lat, lon, popupText) {\n    if (lat && lon) {\n      const map = initMap(containerId, lat, lon, 13);\n      addMarker(map, lat, lon, popupText);\n    }\n  }\n}\n","// src/js/utils/dom.js\nexport function createElement(tag, attributes = {}) {\n  const element = document.createElement(tag);\n  Object.entries(attributes).forEach(([key, value]) => {\n    element.setAttribute(key, value);\n  });\n  return element;\n}\n","import { openDB } from 'idb';\n\nconst DB_NAME = 'story-app-db';\nconst DB_VERSION = 1;\nconst STORY_STORE = 'stories';\n\nexport async function initDB() {\n  const db = await openDB(DB_NAME, DB_VERSION, {\n    upgrade(db) {\n      if (!db.objectStoreNames.contains(STORY_STORE)) {\n        const storyStore = db.createObjectStore(STORY_STORE, { keyPath: 'id' });\n        storyStore.createIndex('createdAt', 'createdAt');\n      }\n    },\n  });\n  return db;\n}\n\nexport async function saveStories(stories) {\n  const db = await initDB();\n  const tx = db.transaction(STORY_STORE, 'readwrite');\n  await Promise.all([\n    ...stories.map(story => tx.store.put(story)),\n    tx.done\n  ]);\n}\n\nexport async function getStoredStories() {\n  const db = await initDB();\n  return db.getAllFromIndex(STORY_STORE, 'createdAt');\n}\n\nexport async function deleteStory(id) {\n  const db = await initDB();\n  await db.delete(STORY_STORE, id);\n}\n\nexport async function clearStories() {\n  const db = await initDB();\n  await db.clear(STORY_STORE);\n}","// src/js/views/home.js\nimport HomePresenter from \"../presenters/home-presenter.js\";\nimport { createElement } from \"../utils/dom.js\";\nimport { saveStories } from \"../db.js\";\n\nexport default class HomeView {\n  constructor() {\n    this.presenter = new HomePresenter(this);\n  }\n\n  async init() {\n    const content = createElement(\"div\", { \n      class: \"home-container\",\n      role: \"region\",\n      \"aria-label\": \"Daftar cerita\"\n    });\n    \n    content.innerHTML = `\n      <h2 id=\"story-list-title\">Daftar Cerita</h2>\n      <div \n        id=\"story-list\" \n        role=\"feed\" \n        aria-labelledby=\"story-list-title\"\n        class=\"stories-container\"\n      ></div>\n    `;\n    \n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    await this.presenter.loadStories();\n  }\n\n  displayStories(stories) {\n    const storyList = document.getElementById(\"story-list\");\n    storyList.innerHTML = \"\";\n    \n    stories.forEach((story) => {\n      const storyItem = createElement(\"div\", { \n        class: \"story-item\",\n        role: \"article\"\n      });\n      \n      storyItem.innerHTML = `\n        <h3>${story.name}</h3>\n        <p>${story.description}</p>\n        <img \n          src=\"${story.photoUrl}\" \n          alt=\"Foto untuk cerita: ${story.description.substring(0, 50)}...\" \n          loading=\"lazy\"\n          class=\"story-image\"\n        >\n        <p>Dibuat pada: ${new Date(story.createdAt).toLocaleDateString('id-ID', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric'\n        })}</p>\n        ${\n          story.lat && story.lon\n            ? `<div \n                id=\"map-${story.id}\" \n                class=\"story-map\" \n                role=\"complementary\" \n                aria-label=\"Lokasi cerita di peta\"\n              ></div>`\n            : \"\"\n        }\n        <div class=\"story-actions\">\n          <a \n            href=\"#/detail/${story.id}\" \n            class=\"detail-link\"\n            aria-label=\"Lihat detail cerita dari ${story.name}\"\n          >Lihat Detail</a>\n          <button \n            class=\"save-favorite-btn\" \n            data-story='${JSON.stringify(story).replace(/'/g, \"&apos;\")}'\n            aria-label=\"Simpan ke favorit\"\n          >\n            ❤️ Simpan ke Favorit\n          </button>\n        </div>\n      `;\n      \n      storyList.appendChild(storyItem);\n\n      if (story.lat && story.lon) {\n        this.presenter.initMap(\n          `map-${story.id}`,\n          story.lat,\n          story.lon,\n          story.name\n        );\n      }\n    });\n\n    // Add event listeners for save buttons\n    document.querySelectorAll('.save-favorite-btn').forEach(btn => {\n      btn.addEventListener('click', async (e) => {\n        const storyData = JSON.parse(e.target.dataset.story.replace(/&apos;/g, \"'\"));\n        await this.saveFavorite(storyData);\n      });\n    });\n  }\n\n  async saveFavorite(story) {\n    try {\n      await saveStories([story]);\n      this.showMessage(\"Cerita berhasil disimpan ke favorit!\");\n    } catch (error) {\n      this.showMessage(`Gagal menyimpan cerita: ${error.message}`);\n    }\n  }\n\n  showMessage(message, retryCallback) {\n    const storyList = document.getElementById(\"story-list\");\n    if (retryCallback) {\n      storyList.innerHTML = `\n        <div role=\"alert\">\n          <p>${message}</p>\n          <button id=\"retry-btn\" class=\"retry-button\">Coba Lagi</button>\n        </div>\n      `;\n      \n      document\n        .getElementById(\"retry-btn\")\n        .addEventListener(\"click\", retryCallback);\n    } else {\n      alert(message);\n    }\n  }\n}","// src/js/utils/auth.js\nexport function saveToken(token) {\n  localStorage.setItem(\"token\", token);\n}\n\nexport function getToken() {\n  return localStorage.getItem(\"token\");\n}\n\nexport function removeToken() {\n  localStorage.removeItem(\"token\");\n}\n","// src/js/views/landing.js\nimport { createElement } from \"../utils/dom.js\";\nimport { getToken } from \"../utils/auth.js\";\n\nexport default class LandingView {\n  constructor() {\n    this.installPrompt = null;\n  }\n\n  async init() {\n    const token = getToken();\n    \n    const content = createElement(\"div\", { \n      class: \"landing-container\",\n      role: \"main\"\n    });\n    \n    content.innerHTML = `\n      <section class=\"hero-section\">\n        <div class=\"hero-content\">\n          <h1 class=\"hero-title\">Share Your Stories</h1>\n          <p class=\"hero-subtitle\">Capture and share your special moments with the Dicoding community</p>\n          <div class=\"hero-actions\">\n            <a href=\"#/add-story\" class=\"btn btn-primary\">Create New Story</a>\n            <a href=\"#/stories\" class=\"btn btn-secondary\">Browse Stories</a>\n          </div>\n        </div>\n        <div class=\"hero-image\">\n          <div class=\"story-preview\">\n            <div class=\"story-card\">\n              <div class=\"story-placeholder\"></div>\n              <h3>Your Story Here</h3>\n              <p>Share your amazing experiences</p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <section class=\"features-section\">\n        <div class=\"container\">\n          <h2 class=\"section-title\">Why Choose StoryApp?</h2>\n          <div class=\"features-grid\">\n            <div class=\"feature-card\">\n              <div class=\"feature-icon\">📸</div>\n              <h3>Photo Stories</h3>\n              <p>Capture moments with your camera and share them instantly</p>\n            </div>\n            <div class=\"feature-card\">\n              <div class=\"feature-icon\">🗺️</div>\n              <h3>Location Sharing</h3>\n              <p>Add location data to your stories and explore places</p>\n            </div>\n            <div class=\"feature-card\">\n              <div class=\"feature-icon\">❤️</div>\n              <h3>Save Favorites</h3>\n              <p>Keep your favorite stories for offline reading</p>\n            </div>\n            <div class=\"feature-card\">\n              <div class=\"feature-icon\">🔔</div>\n              <h3>Push Notifications</h3>\n              <p>Get notified when new stories are shared</p>\n            </div>\n          </div>\n        </div>\n      </section>\n\n      <section class=\"install-section\">\n        <div class=\"install-card\">\n          <div class=\"install-content\">\n            <h3>Install StoryApp for a better experience!</h3>\n            <p>Get the full app experience with offline access and push notifications</p>\n            <div class=\"install-actions\">\n              <button id=\"install-btn\" class=\"btn btn-install\">Install</button>\n              <button id=\"not-now-btn\" class=\"btn btn-outline\">Not Now</button>\n            </div>\n          </div>\n          <div class=\"install-icon\">📱</div>\n        </div>\n      </section>\n\n      ${token ? `\n        <section class=\"featured-stories-section\">\n          <div class=\"container\">\n            <h2 class=\"section-title\">Featured Stories</h2>\n            <div id=\"featured-stories\" class=\"stories-preview\"></div>\n            <div class=\"view-all-container\">\n              <a href=\"#/stories\" class=\"btn btn-outline\">View All Stories</a>\n            </div>\n          </div>\n        </section>\n      ` : ''}\n    `;\n    \n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    this.setupInstallPrompt();\n    \n    if (token) {\n      await this.loadFeaturedStories();\n    }\n  }\n\n  setupInstallPrompt() {\n    const installBtn = document.getElementById(\"install-btn\");\n    const notNowBtn = document.getElementById(\"not-now-btn\");\n    const installSection = document.querySelector(\".install-section\");\n\n    // Listen for beforeinstallprompt event\n    window.addEventListener('beforeinstallprompt', (e) => {\n      e.preventDefault();\n      this.installPrompt = e;\n      installSection.style.display = 'block';\n    });\n\n    installBtn.addEventListener(\"click\", async () => {\n      if (this.installPrompt) {\n        this.installPrompt.prompt();\n        const result = await this.installPrompt.userChoice;\n        if (result.outcome === 'accepted') {\n          installSection.style.display = 'none';\n        }\n        this.installPrompt = null;\n      } else {\n        // Fallback for browsers that don't support PWA installation\n        this.showMessage(\"To install this app, use your browser's 'Add to Home Screen' option in the menu.\");\n      }\n    });\n\n    notNowBtn.addEventListener(\"click\", () => {\n      installSection.style.display = 'none';\n    });\n\n    // Hide install section if app is already installed\n    if (window.matchMedia('(display-mode: standalone)').matches) {\n      installSection.style.display = 'none';\n    }\n  }\n\n  async loadFeaturedStories() {\n    try {\n      const token = getToken();\n      if (!token) return;\n\n      const response = await fetch('https://story-api.dicoding.dev/v1/stories?page=1&size=3&location=1', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      const data = await response.json();\n      if (data.listStory && data.listStory.length > 0) {\n        this.displayFeaturedStories(data.listStory);\n      }\n    } catch (error) {\n      console.error('Error loading featured stories:', error);\n    }\n  }\n\n  displayFeaturedStories(stories) {\n    const container = document.getElementById(\"featured-stories\");\n    if (!container) return;\n\n    container.innerHTML = stories.map(story => `\n      <div class=\"featured-story-card\">\n        <div class=\"story-image-container\">\n          <img src=\"${story.photoUrl}\" alt=\"${story.description.substring(0, 50)}...\" loading=\"lazy\">\n        </div>\n        <div class=\"story-content\">\n          <h3>${story.name}</h3>\n          <p class=\"story-date\">${new Date(story.createdAt).toLocaleDateString('id-ID', {\n            year: 'numeric',\n            month: 'long',\n            day: 'numeric'\n          })}</p>\n          <p class=\"story-description\">${story.description.substring(0, 100)}...</p>\n          <a href=\"#/detail/${story.id}\" class=\"view-details-btn\">View Details</a>\n        </div>\n      </div>\n    `).join('');\n  }\n\n  showMessage(message) {\n    alert(message);\n  }\n}","// src/js/views/stories.js\nimport HomePresenter from \"../presenters/home-presenter.js\";\nimport { createElement } from \"../utils/dom.js\";\nimport { saveStories } from \"../db.js\";\n\nexport default class StoriesView {\n  constructor() {\n    this.presenter = new HomePresenter(this);\n  }\n\n  async init() {\n    const content = createElement(\"div\", { \n      class: \"stories-page-container\",\n      role: \"region\",\n      \"aria-label\": \"Daftar semua cerita\"\n    });\n    \n    content.innerHTML = `\n      <div class=\"stories-header\">\n        <h1>All Stories</h1>\n        <p>Discover amazing stories from our community</p>\n      </div>\n      \n      <div class=\"stories-filters\">\n        <div class=\"filter-group\">\n          <label for=\"sort-select\">Sort by:</label>\n          <select id=\"sort-select\">\n            <option value=\"newest\">Newest First</option>\n            <option value=\"oldest\">Oldest First</option>\n          </select>\n        </div>\n        <div class=\"filter-group\">\n          <button id=\"refresh-btn\" class=\"btn btn-outline\">🔄 Refresh</button>\n        </div>\n      </div>\n      \n      <div \n        id=\"stories-list\" \n        role=\"feed\" \n        aria-label=\"Daftar cerita\"\n        class=\"stories-container\"\n      ></div>\n      \n      <div id=\"loading-indicator\" class=\"loading-indicator\" style=\"display: none;\">\n        <div class=\"spinner\"></div>\n        <p>Loading stories...</p>\n      </div>\n    `;\n    \n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    this.setupEventListeners();\n    await this.presenter.loadStories();\n  }\n\n  setupEventListeners() {\n    const refreshBtn = document.getElementById(\"refresh-btn\");\n    const sortSelect = document.getElementById(\"sort-select\");\n\n    refreshBtn.addEventListener(\"click\", () => {\n      this.presenter.loadStories();\n    });\n\n    sortSelect.addEventListener(\"change\", (e) => {\n      this.sortStories(e.target.value);\n    });\n  }\n\n  displayStories(stories) {\n    const storiesList = document.getElementById(\"stories-list\");\n    storiesList.innerHTML = \"\";\n    \n    if (stories.length === 0) {\n      storiesList.innerHTML = `\n        <div class=\"empty-state\">\n          <div class=\"empty-icon\">📖</div>\n          <h3>No Stories Yet</h3>\n          <p>Be the first to share your story!</p>\n          <a href=\"#/add-story\" class=\"btn btn-primary\">Create Story</a>\n        </div>\n      `;\n      return;\n    }\n    \n    stories.forEach((story) => {\n      const storyItem = createElement(\"div\", { \n        class: \"story-item\",\n        role: \"article\"\n      });\n      \n      storyItem.innerHTML = `\n        <div class=\"story-header\">\n          <div class=\"story-author\">\n            <div class=\"author-avatar\">\n              ${story.name.charAt(0).toUpperCase()}\n            </div>\n            <div class=\"author-info\">\n              <h3>${story.name}</h3>\n              <p class=\"story-date\">${new Date(story.createdAt).toLocaleDateString('id-ID', {\n                year: 'numeric',\n                month: 'long',\n                day: 'numeric',\n                hour: '2-digit',\n                minute: '2-digit'\n              })}</p>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"story-content\">\n          <p class=\"story-description\">${story.description}</p>\n          <img \n            src=\"${story.photoUrl}\" \n            alt=\"Foto untuk cerita: ${story.description.substring(0, 50)}...\" \n            loading=\"lazy\"\n            class=\"story-image\"\n          >\n        </div>\n        \n        ${story.lat && story.lon ? `\n          <div class=\"story-location\">\n            <div class=\"location-info\">\n              <span class=\"location-icon\">📍</span>\n              <span>Location: ${story.lat.toFixed(4)}, ${story.lon.toFixed(4)}</span>\n            </div>\n            <div \n              id=\"map-${story.id}\" \n              class=\"story-map\" \n              role=\"complementary\" \n              aria-label=\"Lokasi cerita di peta\"\n            ></div>\n          </div>\n        ` : ''}\n        \n        <div class=\"story-actions\">\n          <a \n            href=\"#/detail/${story.id}\" \n            class=\"action-btn detail-btn\"\n            aria-label=\"Lihat detail cerita dari ${story.name}\"\n          >\n            <span class=\"btn-icon\">👁️</span>\n            View Details\n          </a>\n          <button \n            class=\"action-btn favorite-btn\" \n            data-story='${JSON.stringify(story).replace(/'/g, \"&apos;\")}'\n            aria-label=\"Simpan ke favorit\"\n          >\n            <span class=\"btn-icon\">❤️</span>\n            Save to Favorites\n          </button>\n        </div>\n      `;\n      \n      storiesList.appendChild(storyItem);\n\n      if (story.lat && story.lon) {\n        this.presenter.initMap(\n          `map-${story.id}`,\n          story.lat,\n          story.lon,\n          story.name\n        );\n      }\n    });\n\n    // Add event listeners for favorite buttons\n    document.querySelectorAll('.favorite-btn').forEach(btn => {\n      btn.addEventListener('click', async (e) => {\n        const storyData = JSON.parse(e.target.closest('.favorite-btn').dataset.story.replace(/&apos;/g, \"'\"));\n        await this.saveFavorite(storyData);\n      });\n    });\n  }\n\n  async saveFavorite(story) {\n    try {\n      await saveStories([story]);\n      this.showMessage(\"Cerita berhasil disimpan ke favorit!\");\n    } catch (error) {\n      this.showMessage(`Gagal menyimpan cerita: ${error.message}`);\n    }\n  }\n\n  sortStories(sortType) {\n    const storiesContainer = document.getElementById(\"stories-list\");\n    const storyItems = Array.from(storiesContainer.querySelectorAll('.story-item'));\n    \n    storyItems.sort((a, b) => {\n      const dateA = new Date(a.querySelector('.story-date').textContent);\n      const dateB = new Date(b.querySelector('.story-date').textContent);\n      \n      return sortType === 'newest' ? dateB - dateA : dateA - dateB;\n    });\n    \n    storiesContainer.innerHTML = '';\n    storyItems.forEach(item => storiesContainer.appendChild(item));\n  }\n\n  showMessage(message, retryCallback) {\n    if (retryCallback) {\n      const storiesList = document.getElementById(\"stories-list\");\n      storiesList.innerHTML = `\n        <div class=\"error-state\" role=\"alert\">\n          <div class=\"error-icon\">⚠️</div>\n          <h3>Oops! Something went wrong</h3>\n          <p>${message}</p>\n          <button id=\"retry-btn\" class=\"btn btn-primary\">Try Again</button>\n        </div>\n      `;\n      \n      document.getElementById(\"retry-btn\").addEventListener(\"click\", retryCallback);\n    } else {\n      alert(message);\n    }\n  }\n}","// src/js/notification.js - Enhanced Notification Management\nimport { VAPID_PUBLIC_KEY } from \"./constants.js\";\nimport { subscribeNotifications, unsubscribeFromNotifications } from \"./api.js\";\n\n// Convert VAPID key to Uint8Array\nfunction urlBase64ToUint8Array(base64String) {\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding)\n    .replace(/\\-/g, \"+\")\n    .replace(/_/g, \"/\");\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n}\n\n// Request notification permission\nexport async function requestNotificationPermission() {\n  if (!(\"Notification\" in window)) {\n    console.warn(\"This browser does not support notifications\");\n    return false;\n  }\n\n  if (Notification.permission === \"granted\") {\n    return true;\n  }\n\n  if (Notification.permission === \"denied\") {\n    console.warn(\"Notification permission denied\");\n    return false;\n  }\n\n  try {\n    const permission = await Notification.requestPermission();\n    return permission === \"granted\";\n  } catch (error) {\n    console.error(\"Error requesting notification permission:\", error);\n    return false;\n  }\n}\n\n// Check if push notifications are supported\nexport function isPushNotificationSupported() {\n  return \"serviceWorker\" in navigator && \"PushManager\" in window;\n}\n\n// Get current push subscription\nexport async function getCurrentPushSubscription() {\n  if (!isPushNotificationSupported()) {\n    return null;\n  }\n\n  try {\n    const registration = await navigator.serviceWorker.ready;\n    return await registration.pushManager.getSubscription();\n  } catch (error) {\n    console.error(\"Error getting push subscription:\", error);\n    return null;\n  }\n}\n\n// Check if currently subscribed\nexport async function isCurrentPushSubscriptionAvailable() {\n  const subscription = await getCurrentPushSubscription();\n  return subscription !== null;\n}\n\n// Subscribe to push notifications\nexport async function subscribePushNotification(token) {\n  if (!isPushNotificationSupported()) {\n    throw new Error(\"Push notifications are not supported in this browser\");\n  }\n\n  // Request permission first\n  const hasPermission = await requestNotificationPermission();\n  if (!hasPermission) {\n    throw new Error(\"Notification permission not granted\");\n  }\n\n  try {\n    const registration = await navigator.serviceWorker.ready;\n    \n    // Check if already subscribed\n    let subscription = await registration.pushManager.getSubscription();\n    \n    if (!subscription) {\n      // Create new subscription\n      subscription = await registration.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: urlBase64ToUint8Array(VAPID_PUBLIC_KEY),\n      });\n    }\n\n    // Send subscription to server\n    try {\n      await subscribeNotifications(subscription, token);\n      console.log(\"Successfully subscribed to push notifications\");\n      return subscription;\n    } catch (serverError) {\n      // Rollback: unsubscribe from client if server registration fails\n      console.error(\"Server subscription failed, rolling back:\", serverError);\n      await subscription.unsubscribe();\n      throw new Error(`Failed to register subscription with server: ${serverError.message}`);\n    }\n  } catch (error) {\n    console.error(\"Error subscribing to push notifications:\", error);\n    throw error;\n  }\n}\n\n// Unsubscribe from push notifications\nexport async function unsubscribePushNotification(token) {\n  if (!isPushNotificationSupported()) {\n    throw new Error(\"Push notifications are not supported in this browser\");\n  }\n\n  try {\n    const subscription = await getCurrentPushSubscription();\n    \n    if (!subscription) {\n      console.log(\"No active subscription found\");\n      return true;\n    }\n\n    // Unsubscribe from server first\n    try {\n      await unsubscribeFromNotifications(subscription.endpoint, token);\n    } catch (serverError) {\n      console.warn(\"Server unsubscription failed:\", serverError);\n      // Continue with client unsubscription even if server fails\n    }\n\n    // Unsubscribe from client\n    const success = await subscription.unsubscribe();\n    console.log(\"Successfully unsubscribed from push notifications\");\n    return success;\n  } catch (error) {\n    console.error(\"Error unsubscribing from push notifications:\", error);\n    throw error;\n  }\n}\n\n// Show local notification (for immediate feedback)\nexport async function showStoryNotification(title, body, data = {}) {\n  if (!(\"Notification\" in window)) {\n    console.warn(\"This browser does not support notifications\");\n    return;\n  }\n\n  if (Notification.permission !== \"granted\") {\n    console.warn(\"Notification permission not granted\");\n    return;\n  }\n\n  try {\n    // Use Service Worker to show notification if available\n    if (\"serviceWorker\" in navigator) {\n      const registration = await navigator.serviceWorker.ready;\n      await registration.showNotification(title, {\n        body: body,\n        icon: \"/icons/icon-192x192.png\",\n        badge: \"/icons/icon-96x96.png\",\n        tag: \"story-notification\",\n        data: data,\n        requireInteraction: false,\n        vibrate: [200, 100, 200],\n        actions: [\n          {\n            action: \"view\",\n            title: \"View Stories\"\n          }\n        ]\n      });\n    } else {\n      // Fallback to regular notification\n      new Notification(title, {\n        body: body,\n        icon: \"/icons/icon-192x192.png\",\n        tag: \"story-notification\"\n      });\n    }\n  } catch (error) {\n    console.error(\"Error showing notification:\", error);\n  }\n}\n\n// Get notification subscription status for UI\nexport async function getNotificationStatus() {\n  const isSupported = isPushNotificationSupported();\n  const permission = \"Notification\" in window ? Notification.permission : \"unsupported\";\n  const isSubscribed = await isCurrentPushSubscriptionAvailable();\n  \n  return {\n    isSupported,\n    permission,\n    isSubscribed,\n    canSubscribe: isSupported && permission !== \"denied\"\n  };\n}\n\n// Initialize notification system\nexport async function initializeNotifications() {\n  if (!isPushNotificationSupported()) {\n    console.warn(\"Push notifications not supported\");\n    return false;\n  }\n\n  try {\n    // Register service worker if not already registered\n    if (!navigator.serviceWorker.controller) {\n      await navigator.serviceWorker.register(\"/sw.js\");\n    }\n\n    // Wait for service worker to be ready\n    await navigator.serviceWorker.ready;\n    console.log(\"Notification system initialized\");\n    return true;\n  } catch (error) {\n    console.error(\"Error initializing notifications:\", error);\n    return false;\n  }\n}\n\n// Legacy function name for backward compatibility\nexport const subscribeUser = subscribePushNotification;","// src/js/presenters/add-story-presenter.js - Enhanced with notification trigger\nimport StoryModel from \"../models/story-model.js\";\nimport { initMap, onMapClick, addMarker } from \"../map.js\";\nimport { showStoryNotification } from \"../notification.js\";\nimport { triggerStoryNotification } from \"../api.js\";\n\nexport default class AddStoryPresenter {\n  constructor(view) {\n    this.view = view;\n    this.model = new StoryModel();\n    this.coordinates = {};\n    this.currentMarker = null;\n    this.map = null;\n  }\n\n  initMap(containerId) {\n    this.map = initMap(containerId);\n    \n    onMapClick(this.map, (lat, lon) => {\n      this.setCoordinates(lat, lon);\n      this.view.updateLocationDisplay(lat, lon);\n    });\n    \n    return this.map;\n  }\n\n  setCoordinates(lat, lon) {\n    this.coordinates = { lat, lon };\n    \n    // Remove existing marker if any\n    if (this.currentMarker) {\n      this.map.removeLayer(this.currentMarker);\n    }\n    \n    // Add new marker\n    this.currentMarker = addMarker(this.map, lat, lon, \"Selected location\");\n    \n    console.log(\"Coordinates selected:\", lat, lon);\n  }\n\n  updateMapLocation(lat, lon) {\n    if (this.map) {\n      this.map.setView([lat, lon], 15);\n      this.setCoordinates(lat, lon);\n    }\n  }\n\n  getCoordinates() {\n    return this.coordinates;\n  }\n\n  async addStory(description, photo, lat, lon, token) {\n    try {\n      const response = await this.model.addStory({\n        description,\n        photo,\n        lat: lat || this.coordinates.lat,\n        lon: lon || this.coordinates.lon,\n        token,\n      });\n      \n      // Show immediate local notification\n      await showStoryNotification(\n        \"Story Shared Successfully!\",\n        `Your story \"${description.substring(0, 50)}...\" has been shared with the community.`,\n        { \n          url: \"/#/stories\",\n          action: \"story_shared\"\n        }\n      );\n\n      // Trigger push notification to other users (if endpoint exists)\n      try {\n        const storyData = {\n          id: response.story?.id || Date.now().toString(),\n          name: \"You\", // This would typically come from user data\n          description: description\n        };\n        \n        await triggerStoryNotification(storyData, token);\n      } catch (notificationError) {\n        console.warn(\"Could not trigger push notification:\", notificationError.message);\n        // Don't fail the story creation if notification fails\n      }\n      \n      this.view.showMessage(\"Story shared successfully!\");\n      this.view.stopCamera();\n      \n      // Navigate to stories page after a short delay to show the notification\n      setTimeout(() => {\n        window.location.hash = \"#/stories\";\n      }, 1000);\n      \n    } catch (error) {\n      this.view.showMessage(`Failed to share story: ${error.message}`);\n    }\n  }\n}","// src/js/camera.js\nexport async function startCamera(videoElement) {\n  try {\n    // First attempt: try to use the back camera (environment)\n    const stream = await navigator.mediaDevices.getUserMedia({\n      video: { facingMode: \"environment\" },\n    });\n    videoElement.srcObject = stream;\n    return stream;\n  } catch (error) {\n    // If the specific camera request fails, try a fallback with general video constraint\n    if (error.name === 'NotFoundError' || error.name === 'DevicesNotFoundError') {\n      try {\n        console.warn(\"Environment camera not found, trying fallback to any available camera\");\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true,\n        });\n        videoElement.srcObject = stream;\n        return stream;\n      } catch (fallbackError) {\n        console.error(\"Fallback camera access also failed:\", fallbackError);\n        throw fallbackError;\n      }\n    }\n    console.error(\"Error accessing camera:\", error);\n    throw error;\n  }\n}\n\nexport function captureImage(videoElement, canvasElement) {\n  const context = canvasElement.getContext(\"2d\");\n  canvasElement.width = videoElement.videoWidth;\n  canvasElement.height = videoElement.videoHeight;\n  context.drawImage(\n    videoElement,\n    0,\n    0,\n    canvasElement.width,\n    canvasElement.height\n  );\n  return canvasElement.toDataURL(\"image/jpeg\");\n}\n\nexport function stopCamera(stream) {\n  if (stream) {\n    stream.getTracks().forEach((track) => track.stop());\n  }\n}\n\nexport function dataURLtoFile(dataURL, filename) {\n  const arr = dataURL.split(\",\");\n  const mime = arr[0].match(/:(.*?);/)[1];\n  const bstr = atob(arr[1]);\n  let n = bstr.length;\n  const u8arr = new Uint8Array(n);\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new File([u8arr], filename, { type: mime });\n}","// src/js/views/add-story.js\nimport AddStoryPresenter from \"../presenters/add-story-presenter.js\";\nimport { createElement } from \"../utils/dom.js\";\nimport {\n  startCamera,\n  captureImage,\n  stopCamera,\n  dataURLtoFile,\n} from \"../camera.js\";\nimport { getToken } from \"../utils/auth.js\";\n\nexport default class AddStoryView {\n  constructor() {\n    this.presenter = new AddStoryPresenter(this);\n    this.stream = null;\n    this.photo = null;\n    this.userLocation = null;\n  }\n\n  async init() {\n    const token = getToken();\n    if (!token) {\n      this.showMessage(\"Silakan login terlebih dahulu!\");\n      window.location.hash = \"#/login\";\n      return;\n    }\n\n    const content = createElement(\"div\", { class: \"add-story-container\" });\n    content.innerHTML = `\n      <div class=\"form-header\">\n        <h2>Create New Story</h2>\n        <p>Share your amazing experience with the community</p>\n      </div>\n      \n      <form id=\"add-story-form\" class=\"story-form\">\n        <div class=\"form-group\">\n          <label for=\"description\">Story Description</label>\n          <textarea \n            id=\"description\" \n            required \n            aria-required=\"true\" \n            placeholder=\"Tell us about your experience...\"\n            rows=\"4\"\n          ></textarea>\n          <div class=\"char-counter\">\n            <span id=\"char-count\">0</span>/500 characters\n          </div>\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"photo\">Photo</label>\n          <div class=\"photo-section\">\n            <video id=\"camera\" autoplay playsinline class=\"camera-preview\"></video>\n            <img id=\"preview\" class=\"photo-preview\" alt=\"Photo Preview\" style=\"display:none;\" />\n            <canvas id=\"canvas\" style=\"display:none;\"></canvas>\n            \n            <div class=\"camera-controls\">\n              <button type=\"button\" id=\"capture\" class=\"btn btn-camera\">\n                <span class=\"btn-icon\">📷</span>\n                Capture Photo\n              </button>\n              <button type=\"button\" id=\"retake\" class=\"btn btn-outline\" style=\"display:none;\">\n                <span class=\"btn-icon\">🔄</span>\n                Retake\n              </button>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"form-group\">\n          <label for=\"location\">Location</label>\n          <p class=\"location-help\">Click on the map to set your story's location (optional)</p>\n          \n          <div class=\"location-controls\">\n            <button type=\"button\" id=\"use-my-location\" class=\"btn btn-location\">\n              <span class=\"btn-icon\">📍</span>\n              Use My Location\n            </button>\n            <div class=\"location-inputs\">\n              <div class=\"input-group\">\n                <label for=\"latitude\">Latitude</label>\n                <input type=\"number\" id=\"latitude\" step=\"any\" placeholder=\"Latitude\" readonly>\n              </div>\n              <div class=\"input-group\">\n                <label for=\"longitude\">Longitude</label>\n                <input type=\"number\" id=\"longitude\" step=\"any\" placeholder=\"Longitude\" readonly>\n              </div>\n            </div>\n          </div>\n          \n          <div id=\"location-info\" class=\"location-info\">\n            <span class=\"location-icon\">📍</span>\n            <span class=\"location-text\">No location selected</span>\n          </div>\n          \n          <div id=\"map\" class=\"story-map\"></div>\n        </div>\n        \n        <div class=\"form-actions\">\n          <button type=\"button\" id=\"cancel-btn\" class=\"btn btn-outline\">\n            Cancel\n          </button>\n          <button type=\"submit\" class=\"btn btn-primary\">\n            <span class=\"btn-icon\">📝</span>\n            Share Story\n          </button>\n        </div>\n      </form>\n    `;\n    \n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    await this.initializeForm();\n  }\n\n  async initializeForm() {\n    const video = document.getElementById(\"camera\");\n    \n    try {\n      this.stream = await startCamera(video);\n    } catch (error) {\n      this.showMessage(\n        `Failed to access camera: ${error.message}. Please ensure camera is available and allow camera access in browser settings.`\n      );\n      return;\n    }\n\n    this.presenter.initMap(\"map\");\n    this.setupEventListeners();\n  }\n\n  setupEventListeners() {\n    const descriptionTextarea = document.getElementById(\"description\");\n    const charCount = document.getElementById(\"char-count\");\n    const captureBtn = document.getElementById(\"capture\");\n    const retakeBtn = document.getElementById(\"retake\");\n    const useLocationBtn = document.getElementById(\"use-my-location\");\n    const cancelBtn = document.getElementById(\"cancel-btn\");\n    const form = document.getElementById(\"add-story-form\");\n\n    // Character counter\n    descriptionTextarea.addEventListener(\"input\", (e) => {\n      const length = e.target.value.length;\n      charCount.textContent = length;\n      charCount.style.color = length > 500 ? '#ef476f' : '#6c757d';\n    });\n\n    // Camera controls\n    captureBtn.addEventListener(\"click\", () => {\n      this.capturePhoto();\n    });\n\n    retakeBtn.addEventListener(\"click\", () => {\n      this.retakePhoto();\n    });\n\n    // Location controls\n    useLocationBtn.addEventListener(\"click\", () => {\n      this.getCurrentLocation();\n    });\n\n    // Cancel button\n    cancelBtn.addEventListener(\"click\", () => {\n      if (confirm(\"Are you sure you want to cancel? Your story will be lost.\")) {\n        this.stopCamera();\n        window.location.hash = \"#/stories\";\n      }\n    });\n\n    // Form submission\n    form.addEventListener(\"submit\", async (e) => {\n      e.preventDefault();\n      await this.submitStory();\n    });\n  }\n\n  capturePhoto() {\n    const video = document.getElementById(\"camera\");\n    const canvas = document.getElementById(\"canvas\");\n    const preview = document.getElementById(\"preview\");\n    const captureBtn = document.getElementById(\"capture\");\n    const retakeBtn = document.getElementById(\"retake\");\n\n    const dataURL = captureImage(video, canvas);\n    this.photo = dataURLtoFile(dataURL, \"story.jpg\");\n    \n    preview.src = dataURL;\n    preview.style.display = \"block\";\n    video.style.display = \"none\";\n    captureBtn.style.display = \"none\";\n    retakeBtn.style.display = \"inline-flex\";\n  }\n\n  retakePhoto() {\n    const video = document.getElementById(\"camera\");\n    const preview = document.getElementById(\"preview\");\n    const captureBtn = document.getElementById(\"capture\");\n    const retakeBtn = document.getElementById(\"retake\");\n\n    this.photo = null;\n    preview.style.display = \"none\";\n    video.style.display = \"block\";\n    captureBtn.style.display = \"inline-flex\";\n    retakeBtn.style.display = \"none\";\n  }\n\n  async getCurrentLocation() {\n    const useLocationBtn = document.getElementById(\"use-my-location\");\n    const originalText = useLocationBtn.innerHTML;\n    \n    useLocationBtn.innerHTML = '<span class=\"spinner-small\"></span> Getting location...';\n    useLocationBtn.disabled = true;\n\n    try {\n      const position = await new Promise((resolve, reject) => {\n        navigator.geolocation.getCurrentPosition(resolve, reject, {\n          enableHighAccuracy: true,\n          timeout: 10000,\n          maximumAge: 60000\n        });\n      });\n\n      const { latitude, longitude } = position.coords;\n      this.updateLocationDisplay(latitude, longitude);\n      this.presenter.setCoordinates(latitude, longitude);\n      \n      // Update map to show user's location\n      this.presenter.updateMapLocation(latitude, longitude);\n      \n    } catch (error) {\n      this.showMessage(`Failed to get location: ${error.message}`);\n    } finally {\n      useLocationBtn.innerHTML = originalText;\n      useLocationBtn.disabled = false;\n    }\n  }\n\n  updateLocationDisplay(lat, lon) {\n    const locationInfo = document.getElementById(\"location-info\");\n    const latInput = document.getElementById(\"latitude\");\n    const lonInput = document.getElementById(\"longitude\");\n    \n    locationInfo.innerHTML = `\n      <span class=\"location-icon\">📍</span>\n      <span class=\"location-text\">Location: ${lat.toFixed(6)}, ${lon.toFixed(6)}</span>\n    `;\n    locationInfo.classList.add(\"location-selected\");\n    \n    latInput.value = lat.toFixed(6);\n    lonInput.value = lon.toFixed(6);\n  }\n\n  async submitStory() {\n    const description = document.getElementById(\"description\").value.trim();\n    const token = getToken();\n\n    if (!description) {\n      this.showMessage(\"Please enter a story description!\");\n      return;\n    }\n\n    if (description.length > 500) {\n      this.showMessage(\"Story description must be 500 characters or less!\");\n      return;\n    }\n\n    if (!this.photo) {\n      this.showMessage(\"Please capture a photo first!\");\n      return;\n    }\n\n    const { lat, lon } = this.presenter.getCoordinates();\n    \n    // Show loading state\n    const submitBtn = document.querySelector('button[type=\"submit\"]');\n    const originalText = submitBtn.innerHTML;\n    submitBtn.innerHTML = '<span class=\"spinner-small\"></span> Sharing...';\n    submitBtn.disabled = true;\n\n    try {\n      await this.presenter.addStory(description, this.photo, lat, lon, token);\n    } catch (error) {\n      submitBtn.innerHTML = originalText;\n      submitBtn.disabled = false;\n    }\n  }\n\n  stopCamera() {\n    stopCamera(this.stream);\n  }\n\n  showMessage(message) {\n    alert(message);\n  }\n}","// src/js/presenters/detail-presenter.js\nimport StoryModel from \"../models/story-model.js\"; // dari src/js/presenters/ ke src/js/models/story-model.js\nimport { initMap, addMarker } from \"../map.js\"; // dari src/js/presenters/ ke src/js/map.js\n\nexport default class DetailPresenter {\n  constructor(view) {\n    this.view = view;\n    this.model = new StoryModel();\n  }\n\n  async getStoryDetail(id, token) {\n    try {\n      const story = await this.model.getStoryDetail(id, token);\n      return story;\n    } catch (error) {\n      throw new Error(`Gagal mengambil detail cerita: ${error.message}`);\n    }\n  }\n\n  initMap(containerId, lat, lon, popupText) {\n    if (lat && lon) {\n      const map = initMap(containerId, lat, lon, 13);\n      addMarker(map, lat, lon, popupText);\n    }\n  }\n}\n","// src/js/views/detail.js\nimport DetailPresenter from \"../presenters/detail-presenter.js\";\nimport { createElement } from \"../utils/dom.js\";\nimport { getToken } from \"../utils/auth.js\";\nimport { saveStories } from \"../db.js\";\n\nexport default class DetailView {\n  constructor() {\n    this.presenter = new DetailPresenter(this);\n  }\n\n  async init({ id }) {\n    const token = getToken();\n    if (!token) {\n      window.location.hash = \"#/login\";\n      return;\n    }\n\n    const content = createElement(\"div\", { class: \"detail-container\" });\n    content.innerHTML = `\n      <div class=\"detail-header\">\n        <button id=\"back-btn\" class=\"btn btn-outline\">\n          <span class=\"btn-icon\">←</span>\n          Back to Stories\n        </button>\n        <div class=\"detail-actions\">\n          <button id=\"save-favorite\" class=\"btn btn-outline\">\n            <span class=\"btn-icon\">❤️</span>\n            Save to Favorites\n          </button>\n          <button id=\"share-story\" class=\"btn btn-outline\">\n            <span class=\"btn-icon\">📤</span>\n            Share\n          </button>\n        </div>\n      </div>\n      \n      <div id=\"story-detail\" class=\"story-detail-content\">\n        <div class=\"loading-state\">\n          <div class=\"spinner\"></div>\n          <p>Loading story...</p>\n        </div>\n      </div>\n    `;\n    \n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    this.setupEventListeners();\n\n    try {\n      const story = await this.presenter.getStoryDetail(id, token);\n      this.displayStory(story);\n    } catch (error) {\n      this.showError(error.message);\n    }\n  }\n\n  setupEventListeners() {\n    const backBtn = document.getElementById(\"back-btn\");\n    const saveFavoriteBtn = document.getElementById(\"save-favorite\");\n    const shareBtn = document.getElementById(\"share-story\");\n\n    backBtn.addEventListener(\"click\", () => {\n      window.history.back();\n    });\n\n    saveFavoriteBtn.addEventListener(\"click\", () => {\n      if (this.currentStory) {\n        this.saveFavorite(this.currentStory);\n      }\n    });\n\n    shareBtn.addEventListener(\"click\", () => {\n      if (this.currentStory) {\n        this.shareStory(this.currentStory);\n      }\n    });\n  }\n\n  displayStory(story) {\n    this.currentStory = story;\n    const storyDetail = document.getElementById(\"story-detail\");\n    \n    storyDetail.innerHTML = `\n      <article class=\"story-article\">\n        <header class=\"story-header\">\n          <div class=\"author-section\">\n            <div class=\"author-avatar\">\n              ${story.name.charAt(0).toUpperCase()}\n            </div>\n            <div class=\"author-info\">\n              <h1 class=\"story-author\">${story.name}</h1>\n              <time class=\"story-date\" datetime=\"${story.createdAt}\">\n                ${new Date(story.createdAt).toLocaleDateString('id-ID', {\n                  weekday: 'long',\n                  year: 'numeric',\n                  month: 'long',\n                  day: 'numeric',\n                  hour: '2-digit',\n                  minute: '2-digit'\n                })}\n              </time>\n            </div>\n          </div>\n        </header>\n\n        <div class=\"story-content\">\n          <div class=\"story-image-container\">\n            <img \n              src=\"${story.photoUrl}\" \n              alt=\"Story photo by ${story.name}\" \n              class=\"story-image\"\n              loading=\"lazy\"\n            >\n          </div>\n          \n          <div class=\"story-text\">\n            <p class=\"story-description\">${story.description}</p>\n          </div>\n\n          ${story.lat && story.lon ? `\n            <div class=\"story-location-section\">\n              <h3 class=\"location-title\">\n                <span class=\"location-icon\">📍</span>\n                Story Location\n              </h3>\n              <div class=\"location-coordinates\">\n                <span class=\"coordinate\">\n                  <strong>Latitude:</strong> ${story.lat.toFixed(6)}\n                </span>\n                <span class=\"coordinate\">\n                  <strong>Longitude:</strong> ${story.lon.toFixed(6)}\n                </span>\n              </div>\n              <div id=\"map-detail\" class=\"story-map-detail\"></div>\n            </div>\n          ` : ''}\n        </div>\n\n        <footer class=\"story-footer\">\n          <div class=\"story-stats\">\n            <span class=\"stat-item\">\n              <span class=\"stat-icon\">👁️</span>\n              <span class=\"stat-text\">Story viewed</span>\n            </span>\n          </div>\n        </footer>\n      </article>\n    `;\n\n    if (story.lat && story.lon) {\n      setTimeout(() => {\n        this.presenter.initMap(\"map-detail\", story.lat, story.lon, story.name);\n      }, 100);\n    }\n  }\n\n  async saveFavorite(story) {\n    try {\n      await saveStories([story]);\n      this.showMessage(\"Story saved to favorites!\");\n      \n      // Update button state\n      const saveBtn = document.getElementById(\"save-favorite\");\n      saveBtn.innerHTML = '<span class=\"btn-icon\">✅</span> Saved';\n      saveBtn.disabled = true;\n      setTimeout(() => {\n        saveBtn.innerHTML = '<span class=\"btn-icon\">❤️</span> Save to Favorites';\n        saveBtn.disabled = false;\n      }, 2000);\n    } catch (error) {\n      this.showMessage(`Failed to save story: ${error.message}`);\n    }\n  }\n\n  shareStory(story) {\n    if (navigator.share) {\n      navigator.share({\n        title: `Story by ${story.name}`,\n        text: story.description,\n        url: window.location.href\n      }).catch(err => console.log('Error sharing:', err));\n    } else {\n      // Fallback for browsers that don't support Web Share API\n      const url = window.location.href;\n      navigator.clipboard.writeText(url).then(() => {\n        this.showMessage(\"Story link copied to clipboard!\");\n      }).catch(() => {\n        this.showMessage(\"Unable to share story. Please copy the URL manually.\");\n      });\n    }\n  }\n\n  showError(message) {\n    const storyDetail = document.getElementById(\"story-detail\");\n    storyDetail.innerHTML = `\n      <div class=\"error-state\">\n        <div class=\"error-icon\">⚠️</div>\n        <h3>Unable to Load Story</h3>\n        <p>${message}</p>\n        <button id=\"retry-btn\" class=\"btn btn-primary\">Try Again</button>\n        <a href=\"#/stories\" class=\"btn btn-outline\">Back to Stories</a>\n      </div>\n    `;\n\n    document.getElementById(\"retry-btn\").addEventListener(\"click\", () => {\n      window.location.reload();\n    });\n  }\n\n  showMessage(message) {\n    // Create a toast notification\n    const toast = createElement(\"div\", { class: \"toast-notification\" });\n    toast.textContent = message;\n    document.body.appendChild(toast);\n\n    setTimeout(() => {\n      toast.classList.add(\"show\");\n    }, 100);\n\n    setTimeout(() => {\n      toast.classList.remove(\"show\");\n      setTimeout(() => {\n        document.body.removeChild(toast);\n      }, 300);\n    }, 3000);\n  }\n}","// src/js/presenters/login-presenter.js\nimport { login } from \"../api.js\";\nimport { saveToken } from \"../utils/auth.js\";\n\nexport default class LoginPresenter {\n  constructor(view) {\n    this.view = view;\n  }\n\n  async login({ email, password }) {\n    try {\n      const response = await login({ email, password });\n      if (response.error) throw new Error(response.message);\n      \n      saveToken(response.loginResult.token);\n      \n      // Save user data for welcome message\n      localStorage.setItem('userData', JSON.stringify({\n        name: response.loginResult.name || email.split('@')[0],\n        email: email\n      }));\n      \n      this.view.showMessage(\"Login berhasil!\");\n      window.location.hash = \"#/\";\n    } catch (error) {\n      if (error.message === \"User not found\") {\n        this.view.showMessage(\n          \"Pengguna tidak ditemukan. Silakan registrasi terlebih dahulu.\"\n        );\n      } else {\n        this.view.showMessage(`Login gagal: ${error.message}`);\n      }\n    }\n  }\n}","// src/js/views/login.js\nimport LoginPresenter from \"../presenters/login-presenter.js\"; // dari src/js/views/ ke src/js/presenters/login-presenter.js\nimport { createElement } from \"../utils/dom.js\"; // dari src/js/views/ ke src/js/utils/dom.js\n\nexport default class LoginView {\n  constructor() {\n    this.presenter = new LoginPresenter(this);\n  }\n\n  async init() {\n    const content = createElement(\"div\", { class: \"auth-container\" });\n    content.innerHTML = `\n      <h2>Login</h2>\n      <form id=\"login-form\">\n        <div class=\"form-group\">\n          <label for=\"email\">Email</label>\n          <input type=\"email\" id=\"email\" required aria-required=\"true\">\n        </div>\n        <div class=\"form-group\">\n          <label for=\"password\">Password</label>\n          <input type=\"password\" id=\"password\" required aria-required=\"true\">\n        </div>\n        <button type=\"submit\" aria-label=\"Masuk ke akun\">Login</button>\n      </form>\n      <p>Belum punya akun? <a href=\"#/register\" aria-label=\"Daftar akun baru\">Register di sini</a></p>\n    `;\n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    document\n      .getElementById(\"login-form\")\n      .addEventListener(\"submit\", async (e) => {\n        e.preventDefault();\n        const email = document.getElementById(\"email\").value;\n        const password = document.getElementById(\"password\").value;\n        await this.presenter.login({ email, password });\n      });\n  }\n\n  showMessage(message) {\n    alert(message);\n  }\n}\n","// src/js/presenters/register-presenter.js\nimport { register } from \"../api.js\";\nimport { saveToken } from \"../utils/auth.js\";\nimport { login } from \"../api.js\";\n\nexport default class RegisterPresenter {\n  constructor(view) {\n    this.view = view;\n  }\n\n  async register({ name, email, password }) {\n    try {\n      const response = await register({ name, email, password });\n      if (response.error) throw new Error(response.message);\n      \n      const loginResponse = await login({ email, password });\n      saveToken(loginResponse.loginResult.token);\n      \n      // Save user data for welcome message\n      localStorage.setItem('userData', JSON.stringify({\n        name: name,\n        email: email\n      }));\n      \n      this.view.showMessage(\"Registrasi berhasil! Anda telah login.\");\n      window.location.hash = \"#/\";\n    } catch (error) {\n      if (error.message === \"Email is already taken\") {\n        this.view.showMessage(\n          \"Email sudah terdaftar. Silakan login atau gunakan email lain.\"\n        );\n      } else if (error.message === \"terjadi kesalahan pada server kami\") {\n        this.view.showMessage(\n          \"Server sedang bermasalah. Silakan coba lagi nanti.\"\n        );\n      } else {\n        this.view.showMessage(`Registrasi gagal: ${error.message}`);\n      }\n    }\n  }\n}","// src/js/views/register.js\nimport RegisterPresenter from \"../presenters/register-presenter.js\";\nimport { createElement } from \"../utils/dom.js\";\n\nexport default class RegisterView {\n  constructor() {\n    this.presenter = new RegisterPresenter(this);\n  }\n\n  async init() {\n    const content = createElement(\"div\", { class: \"auth-container\" });\n    content.innerHTML = `\n      <h2>Register</h2>\n      <form id=\"register-form\">\n        <div class=\"form-group\">\n          <label for=\"name\">Nama</label>\n          <input type=\"text\" id=\"name\" required aria-required=\"true\">\n        </div>\n        <div class=\"form-group\">\n          <label for=\"email\">Email</label>\n          <input type=\"email\" id=\"email\" required aria-required=\"true\">\n        </div>\n        <div class=\"form-group\">\n          <label for=\"password\">Password</label>\n          <input type=\"password\" id=\"password\" required aria-required=\"true\" minlength=\"8\">\n        </div>\n        <button type=\"submit\" aria-label=\"Daftar akun baru\">Register</button>\n      </form>\n      <p>Sudah punya akun? <a href=\"#/login\" aria-label=\"Masuk ke akun\">Login di sini</a></p>\n    `;\n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    document\n      .getElementById(\"register-form\")\n      .addEventListener(\"submit\", async (e) => {\n        e.preventDefault();\n        const name = document.getElementById(\"name\").value.trim();\n        const email = document.getElementById(\"email\").value.trim();\n        const password = document.getElementById(\"password\").value;\n\n        if (!name || !email || !password) {\n          this.showMessage(\"Semua kolom harus diisi!\");\n          return;\n        }\n        await this.presenter.register({ name, email, password });\n      });\n  }\n\n  showMessage(message) {\n    alert(message);\n  }\n}\n","// src/js/views/subscribe.js\nimport { createElement } from \"../utils/dom.js\";\nimport { getToken } from \"../utils/auth.js\";\nimport { subscribePushNotification, requestNotificationPermission } from \"../notification.js\";\n\nexport default class SubscribeView {\n  constructor() {\n    this.isSubscribed = false;\n    this.subscription = null;\n  }\n\n  async init() {\n    const token = getToken();\n    if (!token) {\n      this.showMessage(\"Please login first!\");\n      window.location.hash = \"#/login\";\n      return;\n    }\n\n    const content = createElement(\"div\", { class: \"subscribe-container\" });\n    content.innerHTML = `\n      <div class=\"subscribe-header\">\n        <h2>Push Notifications</h2>\n        <p>Stay updated with the latest stories from our community</p>\n      </div>\n      \n      <div class=\"notification-info\">\n        <div class=\"info-card\">\n          <div class=\"info-icon\">🔔</div>\n          <div class=\"info-content\">\n            <h3>Why Enable Notifications?</h3>\n            <ul>\n              <li>Get notified when new stories are shared</li>\n              <li>Never miss interesting content from the community</li>\n              <li>Receive updates even when the app is closed</li>\n              <li>Stay connected with your favorite storytellers</li>\n            </ul>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"subscription-status-card\">\n        <div class=\"status-header\">\n          <h3>Notification Status</h3>\n          <div id=\"status-indicator\" class=\"status-indicator\">\n            <span class=\"status-dot\"></span>\n            <span id=\"status-text\">Checking...</span>\n          </div>\n        </div>\n        \n        <div class=\"status-details\">\n          <div class=\"detail-item\">\n            <span class=\"detail-label\">Browser Support:</span>\n            <span id=\"browser-support\" class=\"detail-value\">Checking...</span>\n          </div>\n          <div class=\"detail-item\">\n            <span class=\"detail-label\">Permission Status:</span>\n            <span id=\"permission-status\" class=\"detail-value\">Checking...</span>\n          </div>\n          <div class=\"detail-item\">\n            <span class=\"detail-label\">Subscription Status:</span>\n            <span id=\"subscription-status\" class=\"detail-value\">Checking...</span>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"subscription-actions\">\n        <button id=\"subscribe-btn\" class=\"btn btn-primary\" style=\"display: none;\">\n          <span class=\"btn-icon\">🔔</span>\n          Enable Notifications\n        </button>\n        <button id=\"unsubscribe-btn\" class=\"btn btn-danger\" style=\"display: none;\">\n          <span class=\"btn-icon\">🔕</span>\n          Disable Notifications\n        </button>\n        <button id=\"test-notification-btn\" class=\"btn btn-outline\" style=\"display: none;\">\n          <span class=\"btn-icon\">🧪</span>\n          Test Notification\n        </button>\n      </div>\n\n      <div class=\"help-section\">\n        <h3>Troubleshooting</h3>\n        <div class=\"help-content\">\n          <details>\n            <summary>Notifications not working?</summary>\n            <div class=\"help-text\">\n              <p>If notifications aren't working, try these steps:</p>\n              <ol>\n                <li>Make sure notifications are enabled in your browser settings</li>\n                <li>Check that the website has permission to send notifications</li>\n                <li>Ensure you're using a supported browser (Chrome, Firefox, Safari, Edge)</li>\n                <li>Try refreshing the page and subscribing again</li>\n              </ol>\n            </div>\n          </details>\n          \n          <details>\n            <summary>How to manage notifications</summary>\n            <div class=\"help-text\">\n              <p>You can control notifications in several ways:</p>\n              <ul>\n                <li>Use the buttons above to enable/disable notifications</li>\n                <li>Manage notification settings in your browser</li>\n                <li>Block notifications from specific websites in browser settings</li>\n              </ul>\n            </div>\n          </details>\n        </div>\n      </div>\n    `;\n    \n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    await this.initializeSubscription(token);\n  }\n\n  async initializeSubscription(token) {\n    // Check browser support\n    this.checkBrowserSupport();\n    \n    // Check permission status\n    await this.checkPermissionStatus();\n    \n    // Check subscription status\n    await this.checkSubscriptionStatus();\n    \n    // Setup event listeners\n    this.setupEventListeners(token);\n    \n    // Update UI\n    this.updateUI();\n  }\n\n  checkBrowserSupport() {\n    const browserSupportEl = document.getElementById(\"browser-support\");\n    \n    if (\"serviceWorker\" in navigator && \"PushManager\" in window) {\n      browserSupportEl.textContent = \"✅ Supported\";\n      browserSupportEl.className = \"detail-value success\";\n    } else {\n      browserSupportEl.textContent = \"❌ Not Supported\";\n      browserSupportEl.className = \"detail-value error\";\n    }\n  }\n\n  async checkPermissionStatus() {\n    const permissionStatusEl = document.getElementById(\"permission-status\");\n    \n    if (\"Notification\" in window) {\n      const permission = Notification.permission;\n      switch (permission) {\n        case \"granted\":\n          permissionStatusEl.textContent = \"✅ Granted\";\n          permissionStatusEl.className = \"detail-value success\";\n          break;\n        case \"denied\":\n          permissionStatusEl.textContent = \"❌ Denied\";\n          permissionStatusEl.className = \"detail-value error\";\n          break;\n        default:\n          permissionStatusEl.textContent = \"⏳ Not Requested\";\n          permissionStatusEl.className = \"detail-value warning\";\n      }\n    } else {\n      permissionStatusEl.textContent = \"❌ Not Available\";\n      permissionStatusEl.className = \"detail-value error\";\n    }\n  }\n\n  async checkSubscriptionStatus() {\n    const subscriptionStatusEl = document.getElementById(\"subscription-status\");\n    \n    if (\"serviceWorker\" in navigator && \"PushManager\" in window) {\n      try {\n        const registration = await navigator.serviceWorker.ready;\n        this.subscription = await registration.pushManager.getSubscription();\n        \n        if (this.subscription) {\n          this.isSubscribed = true;\n          subscriptionStatusEl.textContent = \"✅ Active\";\n          subscriptionStatusEl.className = \"detail-value success\";\n        } else {\n          this.isSubscribed = false;\n          subscriptionStatusEl.textContent = \"❌ Not Subscribed\";\n          subscriptionStatusEl.className = \"detail-value error\";\n        }\n      } catch (error) {\n        console.error(\"Error checking subscription status:\", error);\n        subscriptionStatusEl.textContent = \"❌ Error\";\n        subscriptionStatusEl.className = \"detail-value error\";\n      }\n    } else {\n      subscriptionStatusEl.textContent = \"❌ Not Available\";\n      subscriptionStatusEl.className = \"detail-value error\";\n    }\n  }\n\n  setupEventListeners(token) {\n    const subscribeBtn = document.getElementById(\"subscribe-btn\");\n    const unsubscribeBtn = document.getElementById(\"unsubscribe-btn\");\n    const testBtn = document.getElementById(\"test-notification-btn\");\n\n    subscribeBtn.addEventListener(\"click\", async () => {\n      await this.handleSubscribe(token);\n    });\n\n    unsubscribeBtn.addEventListener(\"click\", async () => {\n      await this.handleUnsubscribe();\n    });\n\n    testBtn.addEventListener(\"click\", () => {\n      this.testNotification();\n    });\n  }\n\n  async handleSubscribe(token) {\n    const subscribeBtn = document.getElementById(\"subscribe-btn\");\n    const originalText = subscribeBtn.innerHTML;\n    \n    subscribeBtn.innerHTML = '<span class=\"spinner-small\"></span> Subscribing...';\n    subscribeBtn.disabled = true;\n\n    try {\n      const hasPermission = await requestNotificationPermission();\n      if (!hasPermission) {\n        this.showMessage(\"Notification permission is required to subscribe.\");\n        return;\n      }\n\n      await subscribePushNotification(token);\n      this.isSubscribed = true;\n      await this.checkSubscriptionStatus();\n      this.updateUI();\n      this.showMessage(\"Successfully subscribed to notifications!\");\n    } catch (error) {\n      console.error(\"Subscription error:\", error);\n      this.showMessage(`Failed to subscribe: ${error.message}`);\n    } finally {\n      subscribeBtn.innerHTML = originalText;\n      subscribeBtn.disabled = false;\n    }\n  }\n\n  async handleUnsubscribe() {\n    const unsubscribeBtn = document.getElementById(\"unsubscribe-btn\");\n    const originalText = unsubscribeBtn.innerHTML;\n    \n    unsubscribeBtn.innerHTML = '<span class=\"spinner-small\"></span> Unsubscribing...';\n    unsubscribeBtn.disabled = true;\n\n    try {\n      if (this.subscription) {\n        await this.subscription.unsubscribe();\n        this.isSubscribed = false;\n        this.subscription = null;\n        await this.checkSubscriptionStatus();\n        this.updateUI();\n        this.showMessage(\"Successfully unsubscribed from notifications!\");\n      }\n    } catch (error) {\n      console.error(\"Unsubscription error:\", error);\n      this.showMessage(`Failed to unsubscribe: ${error.message}`);\n    } finally {\n      unsubscribeBtn.innerHTML = originalText;\n      unsubscribeBtn.disabled = false;\n    }\n  }\n\n  testNotification() {\n    if (Notification.permission === \"granted\") {\n      new Notification(\"Test Notification\", {\n        body: \"This is a test notification from StoryApp!\",\n        icon: \"/icons/icon-192x192.png\",\n        badge: \"/icons/icon-96x96.png\"\n      });\n    } else {\n      this.showMessage(\"Notifications are not enabled. Please enable them first.\");\n    }\n  }\n\n  updateUI() {\n    const statusIndicator = document.getElementById(\"status-indicator\");\n    const statusText = document.getElementById(\"status-text\");\n    const subscribeBtn = document.getElementById(\"subscribe-btn\");\n    const unsubscribeBtn = document.getElementById(\"unsubscribe-btn\");\n    const testBtn = document.getElementById(\"test-notification-btn\");\n\n    const canSubscribe = \"serviceWorker\" in navigator && \n                        \"PushManager\" in window && \n                        Notification.permission !== \"denied\";\n\n    if (this.isSubscribed) {\n      statusIndicator.className = \"status-indicator active\";\n      statusText.textContent = \"Active\";\n      subscribeBtn.style.display = \"none\";\n      unsubscribeBtn.style.display = \"inline-flex\";\n      testBtn.style.display = \"inline-flex\";\n    } else if (canSubscribe) {\n      statusIndicator.className = \"status-indicator inactive\";\n      statusText.textContent = \"Not Subscribed\";\n      subscribeBtn.style.display = \"inline-flex\";\n      unsubscribeBtn.style.display = \"none\";\n      testBtn.style.display = \"none\";\n    } else {\n      statusIndicator.className = \"status-indicator error\";\n      statusText.textContent = \"Not Available\";\n      subscribeBtn.style.display = \"none\";\n      unsubscribeBtn.style.display = \"none\";\n      testBtn.style.display = \"none\";\n    }\n  }\n\n  showMessage(message) {\n    // Create a toast notification\n    const toast = createElement(\"div\", { class: \"toast-notification\" });\n    toast.textContent = message;\n    document.body.appendChild(toast);\n\n    setTimeout(() => {\n      toast.classList.add(\"show\");\n    }, 100);\n\n    setTimeout(() => {\n      toast.classList.remove(\"show\");\n      setTimeout(() => {\n        document.body.removeChild(toast);\n      }, 300);\n    }, 4000);\n  }\n}","// src/js/views/favorites.js\nimport { createElement } from \"../utils/dom.js\";\nimport { getStoredStories, deleteStory } from \"../db.js\";\nimport { initMap, addMarker } from \"../map.js\";\n\nexport default class FavoritesView {\n  constructor() {\n    this.stories = [];\n  }\n\n  async init() {\n    const content = createElement(\"div\", { \n      class: \"home-container\",\n      role: \"region\",\n      \"aria-label\": \"Cerita Favorit\"\n    });\n    \n    content.innerHTML = `\n      <h2 id=\"favorites-title\">Cerita Favorit</h2>\n      <div \n        id=\"favorites-list\" \n        role=\"feed\" \n        aria-labelledby=\"favorites-title\"\n      ></div>\n    `;\n    \n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n\n    await this.loadFavorites();\n  }\n\n  async loadFavorites() {\n    try {\n      this.stories = await getStoredStories();\n      this.displayStories();\n    } catch (error) {\n      this.showMessage(`Gagal memuat cerita favorit: ${error.message}`);\n    }\n  }\n\n  displayStories() {\n    const favoritesList = document.getElementById(\"favorites-list\");\n    \n    if (this.stories.length === 0) {\n      favoritesList.innerHTML = `\n        <div class=\"empty-state\">\n          <p>Belum ada cerita favorit.</p>\n          <a href=\"#/home\" class=\"back-home\">Kembali ke Beranda</a>\n        </div>\n      `;\n      return;\n    }\n\n    favoritesList.innerHTML = \"\";\n    \n    this.stories.forEach((story) => {\n      const storyItem = createElement(\"div\", { \n        class: \"story-item\",\n        role: \"article\"\n      });\n      \n      storyItem.innerHTML = `\n        <h3>${story.name}</h3>\n        <p>${story.description}</p>\n        <img \n          src=\"${story.photoUrl}\" \n          alt=\"Foto untuk cerita: ${story.description.substring(0, 50)}...\" \n          loading=\"lazy\"\n          class=\"story-image\"\n        >\n        <p>Dibuat pada: ${new Date(story.createdAt).toLocaleDateString('id-ID', {\n          year: 'numeric',\n          month: 'long',\n          day: 'numeric'\n        })}</p>\n        ${\n          story.lat && story.lon\n            ? `<div \n                id=\"map-${story.id}\" \n                class=\"story-map\" \n                role=\"complementary\" \n                aria-label=\"Lokasi cerita di peta\"\n              ></div>`\n            : \"\"\n        }\n        <div class=\"story-actions\">\n          <button \n            class=\"remove-favorite-btn\" \n            data-story-id=\"${story.id}\"\n            aria-label=\"Hapus dari favorit\"\n          >\n            Hapus dari Favorit\n          </button>\n        </div>\n      `;\n      \n      favoritesList.appendChild(storyItem);\n\n      if (story.lat && story.lon) {\n        this.initMap(`map-${story.id}`, story.lat, story.lon, story.name);\n      }\n    });\n\n    // Add event listeners for remove buttons\n    document.querySelectorAll('.remove-favorite-btn').forEach(btn => {\n      btn.addEventListener('click', async (e) => {\n        const storyId = e.target.dataset.storyId;\n        await this.removeFavorite(storyId);\n      });\n    });\n  }\n\n  async removeFavorite(storyId) {\n    try {\n      await deleteStory(storyId);\n      await this.loadFavorites(); // Reload the list\n      this.showMessage(\"Cerita berhasil dihapus dari favorit!\");\n    } catch (error) {\n      this.showMessage(`Gagal menghapus cerita: ${error.message}`);\n    }\n  }\n\n  initMap(containerId, lat, lon, popupText) {\n    if (lat && lon) {\n      const map = initMap(containerId, lat, lon, 13);\n      addMarker(map, lat, lon, popupText);\n    }\n  }\n\n  showMessage(message) {\n    alert(message);\n  }\n}","// src/js/views/about.js\nimport { createElement } from \"../utils/dom.js\";\n\nexport default class AboutView {\n  async init() {\n    const content = createElement(\"div\", { \n      class: \"about-container\",\n      role: \"main\"\n    });\n    \n    content.innerHTML = `\n      <div class=\"about-hero\">\n        <div class=\"container\">\n          <h1>About StoryApp</h1>\n          <p class=\"hero-subtitle\">Connecting people through shared experiences</p>\n        </div>\n      </div>\n\n      <div class=\"about-content\">\n        <div class=\"container\">\n          <section class=\"about-section\">\n            <div class=\"section-content\">\n              <div class=\"text-content\">\n                <h2>Our Mission</h2>\n                <p>StoryApp is designed to bring people together through the power of storytelling. We believe that every moment has a story worth sharing, and every story has the potential to inspire, connect, and create meaningful relationships within the Dicoding community.</p>\n                <p>Built as part of the Dicoding Web Development course, this application demonstrates modern web technologies while providing a platform for authentic human connection.</p>\n              </div>\n              <div class=\"image-content\">\n                <div class=\"mission-icon\">🌟</div>\n              </div>\n            </div>\n          </section>\n\n          <section class=\"features-showcase\">\n            <h2>What Makes Us Special</h2>\n            <div class=\"features-grid\">\n              <div class=\"feature-item\">\n                <div class=\"feature-icon\">📱</div>\n                <h3>Progressive Web App</h3>\n                <p>Install on any device for a native app experience with offline capabilities</p>\n              </div>\n              <div class=\"feature-item\">\n                <div class=\"feature-icon\">🗺️</div>\n                <h3>Location Integration</h3>\n                <p>Share where your stories happen with interactive maps powered by OpenStreetMap</p>\n              </div>\n              <div class=\"feature-item\">\n                <div class=\"feature-icon\">📸</div>\n                <h3>Camera Integration</h3>\n                <p>Capture moments directly from your device's camera</p>\n              </div>\n              <div class=\"feature-item\">\n                <div class=\"feature-icon\">🔔</div>\n                <h3>Push Notifications</h3>\n                <p>Stay updated with new stories from the community</p>\n              </div>\n              <div class=\"feature-item\">\n                <div class=\"feature-icon\">♿</div>\n                <h3>Accessibility First</h3>\n                <p>Built with WCAG standards for inclusive user experience</p>\n              </div>\n              <div class=\"feature-item\">\n                <div class=\"feature-icon\">⚡</div>\n                <h3>Fast & Responsive</h3>\n                <p>Optimized performance with smooth transitions and modern design</p>\n              </div>\n            </div>\n          </section>\n\n          <section class=\"tech-stack\">\n            <h2>Technology Stack</h2>\n            <div class=\"tech-grid\">\n              <div class=\"tech-item\">\n                <h4>Frontend</h4>\n                <ul>\n                  <li>Vanilla JavaScript (ES6+)</li>\n                  <li>HTML5 & CSS3</li>\n                  <li>Progressive Web App</li>\n                  <li>Service Workers</li>\n                </ul>\n              </div>\n              <div class=\"tech-item\">\n                <h4>Architecture</h4>\n                <ul>\n                  <li>Single Page Application (SPA)</li>\n                  <li>MVP Pattern</li>\n                  <li>Hash-based Routing</li>\n                  <li>Modular Design</li>\n                </ul>\n              </div>\n              <div class=\"tech-item\">\n                <h4>APIs & Libraries</h4>\n                <ul>\n                  <li>Dicoding Story API</li>\n                  <li>Leaflet.js for Maps</li>\n                  <li>IndexedDB for Storage</li>\n                  <li>Web Push API</li>\n                </ul>\n              </div>\n              <div class=\"tech-item\">\n                <h4>Features</h4>\n                <ul>\n                  <li>Camera Access</li>\n                  <li>Geolocation</li>\n                  <li>Offline Support</li>\n                  <li>Push Notifications</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          <section class=\"team-section\">\n            <h2>Development Team</h2>\n            <div class=\"team-info\">\n              <div class=\"team-member\">\n                <div class=\"member-avatar\">👨‍💻</div>\n                <h3>Dicoding Student</h3>\n                <p>Full Stack Developer</p>\n                <p>Passionate about creating meaningful web applications that connect people and communities.</p>\n              </div>\n            </div>\n          </section>\n\n          <section class=\"contact-section\">\n            <h2>Get In Touch</h2>\n            <div class=\"contact-info\">\n              <p>Have questions, suggestions, or feedback? We'd love to hear from you!</p>\n              <div class=\"contact-methods\">\n                <div class=\"contact-item\">\n                  <span class=\"contact-icon\">🌐</span>\n                  <span>Visit Dicoding.com</span>\n                </div>\n                <div class=\"contact-item\">\n                  <span class=\"contact-icon\">💬</span>\n                  <span>Join our Community</span>\n                </div>\n                <div class=\"contact-item\">\n                  <span class=\"contact-icon\">📧</span>\n                  <span>Share your feedback</span>\n                </div>\n              </div>\n            </div>\n          </section>\n\n          <section class=\"acknowledgments\">\n            <h2>Acknowledgments</h2>\n            <p>Special thanks to:</p>\n            <ul>\n              <li><strong>Dicoding Indonesia</strong> - For providing excellent web development education</li>\n              <li><strong>OpenStreetMap</strong> - For free and open map data</li>\n              <li><strong>Leaflet.js</strong> - For beautiful interactive maps</li>\n              <li><strong>The Web Community</strong> - For continuous innovation and open source contributions</li>\n            </ul>\n          </section>\n        </div>\n      </div>\n    `;\n    \n    document.getElementById(\"content\").innerHTML = \"\";\n    document.getElementById(\"content\").appendChild(content);\n  }\n}","import { createElement } from '../utils/dom.js';\n\nexport default class NotFoundView {\n  init() {\n    const content = createElement('div', { class: 'not-found-container' });\n    content.innerHTML = `\n      <h2>404 - Halaman Tidak Ditemukan</h2>\n      <p>Maaf, halaman yang Anda cari tidak ditemukan.</p>\n      <a href=\"#/home\" class=\"back-home\">Kembali ke Beranda</a>\n    `;\n    document.getElementById('content').innerHTML = '';\n    document.getElementById('content').appendChild(content);\n  }\n}","// src/js/utils/transition.js\nexport function navigateWithTransition(callback) {\n  const content = document.getElementById(\"content\");\n  content.style.opacity = \"0\";\n  setTimeout(() => {\n    callback();\n    content.style.opacity = \"1\";\n  }, 300);\n}\n","import HomeView from './views/home.js';\nimport LandingView from './views/landing.js';\nimport StoriesView from './views/stories.js';\nimport AddStoryView from './views/add-story.js';\nimport DetailView from './views/detail.js';\nimport LoginView from './views/login.js';\nimport RegisterView from './views/register.js';\nimport SubscribeView from './views/subscribe.js';\nimport FavoritesView from './views/favorites.js';\nimport AboutView from './views/about.js';\nimport NotFoundView from './views/not-found.js';\nimport { navigateWithTransition } from './utils/transition.js';\nimport { getToken, removeToken } from './utils/auth.js';\n\nconst routes = {\n  '#/': LandingView,\n  '#/home': HomeView,\n  '#/stories': StoriesView,\n  '#/add-story': AddStoryView,\n  '#/detail/:id': DetailView,\n  '#/login': LoginView,\n  '#/register': RegisterView,\n  '#/subscribe': SubscribeView,\n  '#/favorites': FavoritesView,\n  '#/about': AboutView,\n  '#/404': NotFoundView,\n};\n\nexport function initRouter() {\n  updateNavLinks();\n  window.addEventListener('hashchange', () => {\n    updateNavLinks();\n    renderPage();\n  });\n  window.addEventListener('load', () => {\n    updateNavLinks();\n    renderPage();\n  });\n\n  document.getElementById('logout-link').addEventListener('click', (e) => {\n    e.preventDefault();\n    removeToken();\n    updateNavLinks();\n    window.location.hash = '#/login';\n  });\n}\n\nfunction updateNavLinks() {\n  const token = getToken();\n  const loginLink = document.getElementById('login-link');\n  const logoutLink = document.getElementById('logout-link');\n  const subscribeLink = document.getElementById('subscribe-link');\n  const favoritesLink = document.getElementById('favorites-link');\n  const userWelcome = document.getElementById('user-welcome');\n  \n  if (token) {\n    loginLink.style.display = 'none';\n    logoutLink.style.display = 'inline';\n    if (subscribeLink) subscribeLink.style.display = 'inline';\n    if (favoritesLink) favoritesLink.style.display = 'inline';\n    \n    // Show user welcome message\n    if (userWelcome) {\n      const userData = getUserData();\n      userWelcome.textContent = `Hi, ${userData.name || 'User'}`;\n      userWelcome.style.display = 'inline';\n    }\n  } else {\n    loginLink.style.display = 'inline';\n    logoutLink.style.display = 'none';\n    if (subscribeLink) subscribeLink.style.display = 'none';\n    if (favoritesLink) favoritesLink.style.display = 'none';\n    if (userWelcome) userWelcome.style.display = 'none';\n  }\n}\n\nfunction getUserData() {\n  try {\n    const userData = localStorage.getItem('userData');\n    return userData ? JSON.parse(userData) : { name: 'User' };\n  } catch (error) {\n    return { name: 'User' };\n  }\n}\n\nfunction renderPage() {\n  const hash = window.location.hash || '#/';\n  const route = Object.keys(routes).find((key) => {\n    const regex = new RegExp(`^${key.replace(':id', '([^/]+)')}$`);\n    return regex.test(hash);\n  });\n\n  if (route) {\n    const ViewClass = routes[route];\n    const view = new ViewClass();\n\n    if (route === '#/detail/:id') {\n      const match = hash.match(new RegExp(`^${route.replace(':id', '([^/]+)')}$`));\n      const id = match ? match[1] : null;\n      navigateWithTransition(() => view.init({ id }));\n    } else {\n      navigateWithTransition(() => view.init());\n    }\n  } else {\n    const notFoundView = new NotFoundView();\n    window.location.hash = '#/404';\n    navigateWithTransition(() => notFoundView.init());\n  }\n}","// src/js/main.js - Enhanced main entry point with notification system\nimport { initRouter } from './router.js';\nimport { initDB } from './db.js';\nimport { Workbox } from 'workbox-window';\nimport { \n  initializeNotifications, \n  getNotificationStatus, \n  subscribePushNotification, \n  unsubscribePushNotification \n} from './notification.js';\nimport { getToken } from './utils/auth.js';\n\nasync function init() {\n  await initDB();\n  initRouter();\n  setupInstallPrompt();\n  await setupNotificationSystem();\n\n  if ('serviceWorker' in navigator) {\n    const wb = new Workbox('/sw.js');\n\n    wb.addEventListener('installed', (event) => {\n      if (event.isUpdate) {\n        showUpdateNotification(wb);\n      }\n    });\n\n    wb.addEventListener('waiting', (event) => {\n      showUpdateNotification(wb);\n    });\n\n    wb.addEventListener('controlling', (event) => {\n      window.location.reload();\n    });\n\n    wb.register();\n  }\n}\n\nfunction setupInstallPrompt() {\n  let deferredPrompt;\n  const installBtn = document.getElementById('install-app-btn');\n\n  window.addEventListener('beforeinstallprompt', (e) => {\n    e.preventDefault();\n    deferredPrompt = e;\n    \n    if (installBtn) {\n      installBtn.style.display = 'flex';\n    }\n  });\n\n  if (installBtn) {\n    installBtn.addEventListener('click', async () => {\n      if (deferredPrompt) {\n        deferredPrompt.prompt();\n        const result = await deferredPrompt.userChoice;\n        if (result.outcome === 'accepted') {\n          installBtn.style.display = 'none';\n        }\n        deferredPrompt = null;\n      }\n    });\n  }\n\n  // Hide install button if app is already installed\n  if (window.matchMedia('(display-mode: standalone)').matches) {\n    if (installBtn) {\n      installBtn.style.display = 'none';\n    }\n  }\n}\n\nasync function setupNotificationSystem() {\n  try {\n    // Initialize notification system\n    await initializeNotifications();\n    \n    // Setup notification UI\n    setupNotificationUI();\n    \n    console.log('Notification system setup completed');\n  } catch (error) {\n    console.error('Error setting up notification system:', error);\n  }\n}\n\nfunction setupNotificationUI() {\n  const header = document.querySelector('header nav ul');\n  if (!header) return;\n\n  // Create notification button container\n  const notificationContainer = document.createElement('li');\n  notificationContainer.id = 'notification-container';\n  notificationContainer.style.display = 'none';\n  \n  const notificationBtn = document.createElement('button');\n  notificationBtn.id = 'notification-btn';\n  notificationBtn.className = 'notification-btn';\n  notificationBtn.innerHTML = '<span class=\"btn-icon\">🔔</span><span class=\"btn-text\">Notifications</span>';\n  \n  notificationContainer.appendChild(notificationBtn);\n  \n  // Insert before install button\n  const installBtn = document.getElementById('install-app-btn');\n  if (installBtn && installBtn.parentElement) {\n    header.insertBefore(notificationContainer, installBtn.parentElement);\n  } else {\n    header.appendChild(notificationContainer);\n  }\n\n  // Setup notification button click handler\n  notificationBtn.addEventListener('click', handleNotificationToggle);\n  \n  // Update notification UI based on current status\n  updateNotificationUI();\n}\n\nasync function handleNotificationToggle() {\n  const token = getToken();\n  if (!token) {\n    showToast('Please login first to enable notifications', 'warning');\n    window.location.hash = '#/login';\n    return;\n  }\n\n  const notificationBtn = document.getElementById('notification-btn');\n  const originalContent = notificationBtn.innerHTML;\n  \n  try {\n    notificationBtn.innerHTML = '<span class=\"spinner-small\"></span> Processing...';\n    notificationBtn.disabled = true;\n\n    const status = await getNotificationStatus();\n    \n    if (status.isSubscribed) {\n      // Unsubscribe\n      await unsubscribePushNotification(token);\n      showToast('Notifications disabled successfully', 'success');\n    } else {\n      // Subscribe\n      await subscribePushNotification(token);\n      showToast('Notifications enabled successfully', 'success');\n    }\n    \n    // Update UI\n    await updateNotificationUI();\n    \n  } catch (error) {\n    console.error('Error toggling notifications:', error);\n    showToast(`Error: ${error.message}`, 'error');\n  } finally {\n    notificationBtn.innerHTML = originalContent;\n    notificationBtn.disabled = false;\n  }\n}\n\nasync function updateNotificationUI() {\n  const notificationContainer = document.getElementById('notification-container');\n  const notificationBtn = document.getElementById('notification-btn');\n  \n  if (!notificationContainer || !notificationBtn) return;\n\n  try {\n    const status = await getNotificationStatus();\n    const token = getToken();\n    \n    // Show notification button only if user is logged in and notifications are supported\n    if (token && status.isSupported) {\n      notificationContainer.style.display = 'block';\n      \n      if (status.isSubscribed) {\n        notificationBtn.innerHTML = '<span class=\"btn-icon\">🔕</span><span class=\"btn-text\">Disable</span>';\n        notificationBtn.className = 'notification-btn subscribed';\n        notificationBtn.title = 'Click to disable notifications';\n      } else if (status.canSubscribe) {\n        notificationBtn.innerHTML = '<span class=\"btn-icon\">🔔</span><span class=\"btn-text\">Enable</span>';\n        notificationBtn.className = 'notification-btn unsubscribed';\n        notificationBtn.title = 'Click to enable notifications';\n      } else {\n        notificationBtn.innerHTML = '<span class=\"btn-icon\">🚫</span><span class=\"btn-text\">Blocked</span>';\n        notificationBtn.className = 'notification-btn blocked';\n        notificationBtn.title = 'Notifications are blocked. Please enable in browser settings.';\n        notificationBtn.disabled = true;\n      }\n    } else {\n      notificationContainer.style.display = 'none';\n    }\n  } catch (error) {\n    console.error('Error updating notification UI:', error);\n    notificationContainer.style.display = 'none';\n  }\n}\n\nfunction showUpdateNotification(wb) {\n  const updateBanner = document.createElement('div');\n  updateBanner.className = 'update-banner';\n  updateBanner.innerHTML = `\n    <div class=\"update-content\">\n      <span>🔄 App update available!</span>\n      <button id=\"update-btn\" class=\"btn btn-primary\">Update Now</button>\n      <button id=\"dismiss-update\" class=\"btn btn-outline\">Later</button>\n    </div>\n  `;\n  \n  document.body.appendChild(updateBanner);\n  \n  document.getElementById('update-btn').addEventListener('click', () => {\n    wb.messageSkipWaiting();\n    updateBanner.remove();\n  });\n  \n  document.getElementById('dismiss-update').addEventListener('click', () => {\n    updateBanner.remove();\n  });\n}\n\nfunction showToast(message, type = 'success') {\n  const toast = document.createElement('div');\n  toast.className = `toast-notification ${type}`;\n  toast.textContent = message;\n  \n  document.body.appendChild(toast);\n  \n  setTimeout(() => {\n    toast.classList.add('show');\n  }, 100);\n  \n  setTimeout(() => {\n    toast.classList.remove('show');\n    setTimeout(() => {\n      if (document.body.contains(toast)) {\n        document.body.removeChild(toast);\n      }\n    }, 300);\n  }, 3000);\n}\n\n// Update notification UI when auth state changes\nwindow.addEventListener('hashchange', () => {\n  setTimeout(updateNotificationUI, 100);\n});\n\n// Listen for storage changes (login/logout in other tabs)\nwindow.addEventListener('storage', (e) => {\n  if (e.key === 'token') {\n    setTimeout(updateNotificationUI, 100);\n  }\n});\n\n// Listen for online/offline events\nwindow.addEventListener('online', () => {\n  showToast('Connection restored', 'success');\n});\n\nwindow.addEventListener('offline', () => {\n  showToast('You are offline. Some features may be limited.', 'warning');\n});\n\ninit();"],"names":["BASE_URL","VAPID_PUBLIC_KEY","handleResponse","response","data","errorMessage","register","name","email","password","error","login","addStory","description","photo","lat","lon","token","formData","addGuestStory","getStories","page","size","location","params","getStoryDetail","id","subscribeNotifications","subscription","cleanSubscription","unsubscribeFromNotifications","endpoint","triggerStoryNotification","storyData","notificationPayload","StoryModel","initMap","containerId","zoom","map","L","addMarker","popupText","marker","onMapClick","callback","lng","HomePresenter","view","createElement","tag","attributes","element","key","value","DB_NAME","DB_VERSION","STORY_STORE","initDB","openDB","db","saveStories","stories","tx","story","getStoredStories","deleteStory","HomeView","content","storyList","storyItem","btn","e","message","retryCallback","saveToken","getToken","removeToken","LandingView","installBtn","notNowBtn","installSection","container","StoriesView","refreshBtn","sortSelect","storiesList","sortType","storiesContainer","storyItems","a","b","dateA","dateB","item","urlBase64ToUint8Array","base64String","padding","base64","rawData","outputArray","i","requestNotificationPermission","isPushNotificationSupported","getCurrentPushSubscription","isCurrentPushSubscriptionAvailable","subscribePushNotification","registration","serverError","unsubscribePushNotification","success","showStoryNotification","title","body","getNotificationStatus","isSupported","permission","isSubscribed","initializeNotifications","AddStoryPresenter","_a","notificationError","startCamera","videoElement","stream","fallbackError","captureImage","canvasElement","context","stopCamera","track","dataURLtoFile","dataURL","filename","arr","mime","bstr","n","u8arr","AddStoryView","video","descriptionTextarea","charCount","captureBtn","retakeBtn","useLocationBtn","cancelBtn","form","length","canvas","preview","originalText","position","resolve","reject","latitude","longitude","locationInfo","latInput","lonInput","submitBtn","DetailPresenter","DetailView","backBtn","saveFavoriteBtn","shareBtn","storyDetail","saveBtn","err","url","toast","LoginPresenter","LoginView","RegisterPresenter","loginResponse","RegisterView","SubscribeView","browserSupportEl","permissionStatusEl","subscriptionStatusEl","subscribeBtn","unsubscribeBtn","testBtn","statusIndicator","statusText","canSubscribe","FavoritesView","favoritesList","storyId","AboutView","NotFoundView","navigateWithTransition","routes","initRouter","updateNavLinks","renderPage","loginLink","logoutLink","subscribeLink","favoritesLink","userWelcome","userData","getUserData","hash","route","ViewClass","match","notFoundView","init","setupInstallPrompt","setupNotificationSystem","wb","Workbox","event","showUpdateNotification","deferredPrompt","setupNotificationUI","header","notificationContainer","notificationBtn","handleNotificationToggle","updateNotificationUI","showToast","originalContent","status","updateBanner","type"],"mappings":"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"}